function submitacymailingform(e,t){var n=document[t];var r=/^([a-z0-9_'&\.\-\+=])+\@(([a-z0-9\-])+\.)+([a-z0-9]{2,10})+$/i;if(!n.elements){if(n[0].elements["user[email]"]&&n[0].elements["user[email]"].value&&r.test(n[0].elements["user[email]"].value)){n=n[0]}else{n=n[n.length-1]}}if(e!="optout"){nameField=n.elements["user[name]"];if(nameField&&(typeof acymailing!="undefined"&&nameField.value==acymailing["NAMECAPTION"]||nameField.value.replace(/ /g,"").length<2)){if(typeof acymailing!="undefined"){alert(acymailing["NAME_MISSING"])}nameField.className=nameField.className+" invalid";return false}}var i=n.elements["user[email]"];if(i){if(typeof acymailing=="undefined"||i.value!=acymailing["EMAILCAPTION"])i.value=i.value.replace(/ /g,"");if(!i||typeof acymailing!="undefined"&&i.value==acymailing["EMAILCAPTION"]||!r.test(i.value)){if(typeof acymailing!="undefined"){alert(acymailing["VALID_EMAIL"])}i.className=i.className+" invalid";return false}}if(n.elements["hiddenlists"].value.length<1){var s=false;var o=n.elements["subscription[]"];if(o&&(typeof o.value=="undefined"||o.value.length==0)){for(b=0;b<o.length;b++){if(o[b].checked)s=true}if(!s){alert(acymailing["NO_LIST_SELECTED"]);return false}}}if(e!="optout"&&typeof acymailing!="undefined"&&typeof acymailing["reqFields"+t]!="undefined"&&acymailing["reqFields"+t].length>0){for(var u=0;u<acymailing["reqFields"+t].length;u++){elementName="user["+acymailing["reqFields"+t][u]+"]";elementToCheck=n.elements[elementName];if(elementToCheck){var a=false;if(typeof elementToCheck.value!="undefined"){if(elementToCheck.value==" "&&typeof n[elementName+"[]"]!="undefined"){if(n[elementName+"[]"].checked){a=true}else{for(var f=0;f<n[elementName+"[]"].length;f++){if((n[elementName+"[]"][f].checked||n[elementName+"[]"][f].selected)&&n[elementName+"[]"][f].value.length>0)a=true}}}else{if(elementToCheck.value.replace(/ /g,"").length>0){if(typeof acymailing["excludeValues"+t]=="undefined"||typeof acymailing["excludeValues"+t][acymailing["reqFields"+t][u]]=="undefined"||acymailing["excludeValues"+t][acymailing["reqFields"+t][u]]!=elementToCheck.value)a=true}}}else{for(var f=0;f<elementToCheck.length;f++){if(elementToCheck[f].checked&&elementToCheck[f].value.length>0)a=true}}if(!a){elementToCheck.className=elementToCheck.className+" invalid";alert(acymailing["validFields"+t][u]);return false}}else{if(n.elements[elementName+"[day]"]&&n.elements[elementName+"[day]"].value<1||n.elements[elementName+"[month]"]&&n.elements[elementName+"[month]"].value<1||n.elements[elementName+"[year]"]&&n.elements[elementName+"[year]"].value<1902){if(n.elements[elementName+"[day]"]&&n.elements[elementName+"[day]"].value<1)n.elements[elementName+"[day]"].className=n.elements[elementName+"[day]"].className+" invalid";if(n.elements[elementName+"[month]"]&&n.elements[elementName+"[month]"].value<1)n.elements[elementName+"[month]"].className=n.elements[elementName+"[month]"].className+" invalid";if(n.elements[elementName+"[year]"]&&n.elements[elementName+"[year]"].value<1902)n.elements[elementName+"[year]"].className=n.elements[elementName+"[year]"].className+" invalid";alert(acymailing["validFields"+t][u]);return false}if(n.elements[elementName+"[country]"]&&n.elements[elementName+"[country]"].value<1||n.elements[elementName+"[num]"]&&n.elements[elementName+"[num]"].value<3){if(n.elements[elementName+"[country]"]&&n.elements[elementName+"[country]"].value<1)n.elements[elementName+"[country]"].className=n.elements[elementName+"[country]"].className+" invalid";if(n.elements[elementName+"[num]"]&&n.elements[elementName+"[num]"].value<3)n.elements[elementName+"[num]"].className=n.elements[elementName+"[num]"].className+" invalid";alert(acymailing["validFields"+t][u]);return false}}}}if(e!="optout"&&typeof acymailing!="undefined"&&typeof acymailing["checkFields"+t]!="undefined"&&acymailing["checkFields"+t].length>0){for(var u=0;u<acymailing["checkFields"+t].length;u++){elementName="user["+acymailing["checkFields"+t][u]+"]";elementtypeToCheck=acymailing["checkFieldsType"+t][u];elementToCheck=n.elements[elementName].value;switch(elementtypeToCheck){case"number":myregexp=new RegExp("^[0-9]*$");break;case"letter":myregexp=new RegExp("^[A-Za-zÀ-ſ ]*$");break;case"letnum":myregexp=new RegExp("^[0-9a-zA-ZÀ-ſ ]*$");break;case"regexp":myregexp=new RegExp(acymailing["checkFieldsRegexp"+t][u]);break}if(!myregexp.test(elementToCheck)){alert(acymailing["validCheckFields"+t][u]);return false}}}var l=n.elements["acycaptcha"];if(l){if(l.value.length<1){if(typeof acymailing!="undefined"){alert(acymailing["CAPTCHA_MISSING"])}l.className=l.className+" invalid";return false}}if(e!="optout"){var c=n.terms;if(c&&!c.checked){if(typeof acymailing!="undefined"){alert(acymailing["ACCEPT_TERMS"])}c.className=c.className+" invalid";return false}}taskField=n.task;taskField.value=e;if(!n.elements["ajax"]||!n.elements["ajax"].value||n.elements["ajax"].value=="0"){n.submit();return false}if(window.jQuery){var h=jQuery("#"+t);data=h.serialize();jQuery.ajax({url:document.getElementById(t).action,data:data,type:"POST",async:false,complete:function(){h.addClass("acymailing_module_loading");h.css("filter:","alpha(opacity=50)");h.css("-moz-opacity","0.5");h.css("-khtml-opacity","0.5");h.css("opacity","0.5")},success:function(e){e=JSON.parse(e);acymailingDisplayAjaxResponseJQuery(unescape(e.message),e.type,t)},error:function(){acymailingDisplayAjaxResponseJQuery("Ajax Request Failure","error",t)}})}else{try{var h=document.id(t)}catch(p){var h=$(t)}data=h.toQueryString();if(typeof Ajax=="function"){(new Ajax(h.action,{data:data,method:"post",onRequest:function(){h.addClass("acymailing_module_loading");h.setStyle("filter:","alpha(opacity=50)");h.setStyle("-moz-opacity","0.5");h.setStyle("-khtml-opacity","0.5");h.setStyle("opacity","0.5")},onSuccess:function(e){e=Json.evaluate(e);acymailingDisplayAjaxResponseMootools(unescape(e.message),e.type,t)},onFailure:function(){acymailingDisplayAjaxResponseMootools("Ajax Request Failure","error",t)}})).request()}else{(new Request.JSON({url:document.id(t).action,data:data,method:"post",onRequest:function(){h.addClass("acymailing_module_loading");h.setStyle("filter:","alpha(opacity=50)");h.setStyle("-moz-opacity","0.5");h.setStyle("-khtml-opacity","0.5");h.setStyle("opacity","0.5")},onSuccess:function(e){acymailingDisplayAjaxResponseMootools(unescape(e.message),e.type,t)},onFailure:function(){acymailingDisplayAjaxResponseMootools("Ajax Request Failure","error",t)}})).send()}}return false}function acymailingDisplayAjaxResponseJQuery(e,t,n){var r=jQuery("#acymailing_togglemodule_"+n);if(r&&r.hasClass("acyactive")){var i=r.parent().parent().children()[1];jQuery(i).css("height","")}var s=jQuery("#acymailing_fulldiv_"+n+" .responseContainer")[0];if(typeof s=="undefined"){s=document.createElement("div");var o=jQuery("#acymailing_fulldiv_"+n);o.prepend(s);oldContainerHeight="0px"}else{oldContainerHeight=jQuery(s).css("height")}s.className="responseContainer";var u=jQuery("#"+n);u.removeClass("acymailing_module_loading");s.innerHTML=e;if(t=="success"){jQuery(s).addClass("acymailing_module_success")}else{jQuery(s).addClass("acymailing_module_error");u.css("filter:","alpha(opacity=100)");u.css("-moz-opacity","1");u.css("-khtml-opacity","1");u.css("opacity","1")}newContainerHeight=jQuery(s).css("height");if(t=="success"){u.animate({height:0,opacity:0})}jQuery(s).css({height:oldContainerHeight,"filter:":"alpha(opacity=0)","-moz-opacity":0,"-khtml-opacity":0,opacity:0});jQuery(s).animate({height:newContainerHeight,opacity:1})}function acymailingDisplayAjaxResponseMootools(e,t,n){try{var r=document.id("acymailing_togglemodule_"+n)}catch(i){var r=$("acymailing_togglemodule_"+n)}if(r&&r.hasClass("acyactive")){var s=r.getParent().getParent().getChildren()[1];s.setStyle("height","")}try{var o=document.getElements("#acymailing_fulldiv_"+n+" .responseContainer")[0]}catch(i){var o=$$("#acymailing_fulldiv_"+n+" .responseContainer")[0]}if(typeof o=="undefined"){o=new Element("div");try{var u=document.id("acymailing_fulldiv_"+n)}catch(i){var u=$("acymailing_fulldiv_"+n)}o.inject(u,"top");oldContainerHeight="0px"}else{oldContainerHeight=o.getStyle("height")}o.className="responseContainer";try{var a=document.id(n)}catch(i){var a=$(n)}a.removeClass("acymailing_module_loading");o.innerHTML=e;if(t=="success"){o.addClass("acymailing_module_success")}else{o.addClass("acymailing_module_error");a.setStyle("filter:","alpha(opacity=100)");a.setStyle("-moz-opacity","1");a.setStyle("-khtml-opacity","1");a.setStyle("opacity","1")}newContainerHeight=o.getStyle("height");if(typeof Ajax=="function"){if(t=="success"){var f=new Fx.Styles(a,{duration:500,transition:Fx.Transitions.linear});f.start({height:[a.getSize().size.y,0],opacity:[1,0]})}try{o.setStyle("height",oldContainerHeight+"px");o.setStyle("filter:","alpha(opacity=0)");o.setStyle("-moz-opacity","0");o.setStyle("-khtml-opacity","0");o.setStyle("opacity","0")}catch(l){}var c=new Fx.Styles(o,{duration:500,transition:Fx.Transitions.linear});c.start({height:[oldContainerHeight,newContainerHeight],opacity:[0,1]})}else{if(t=="success"){a.set("morph");a.morph({height:"0px",opacity:0});a.setStyles({display:"none"})}if(newContainerHeight!="auto"){o.setStyles({height:oldContainerHeight,opacity:0});o.set("morph");o.morph({height:newContainerHeight,opacity:1})}}}function refreshCaptchaModule(e){var t=document.getElementById("captcha_picture_"+e).src;myregexp=new RegExp("val[-=]([0-9]+)");valToChange=t.match(myregexp)[1];document.getElementById("captcha_picture_"+e).src=t.replace(valToChange,valToChange+"0")}